---
title: Konfigurer automatisk oprettelse af proformafakturaer
description: Dette emne indeholder oplysninger om, hvordan du konfigurerer automatisk oprettelse af proformafakturaer.
author: rumant
manager: Annbe
ms.date: 10/13/2020
ms.topic: article
ms.service: dynamics-365-customerservice
ms.reviewer: kfend
ms.author: rumant
ms.openlocfilehash: e146dd510b3795d52d164fc6acf8e5400ba11310
ms.sourcegitcommit: 11a61db54119503e82faec5f99c4273e8d1247e5
ms.translationtype: HT
ms.contentlocale: da-DK
ms.lasthandoff: 10/16/2020
ms.locfileid: "4074081"
---
# <a name="configure-automated-proforma-invoice-creation"></a><span data-ttu-id="949bd-103">Konfigurer automatisk oprettelse af proformafakturaer</span><span class="sxs-lookup"><span data-stu-id="949bd-103">Configure automated proforma invoice creation</span></span>

<span data-ttu-id="949bd-104">_**Gælder for:** Lille udrulning - aftale til proformafakturering_</span><span class="sxs-lookup"><span data-stu-id="949bd-104">_**Applies To:** Lite deployment - deal to proforma invoicing_</span></span>

<span data-ttu-id="949bd-105">Du kan konfigurere automatisk oprettelse af faktura i Dynamics 365 Project Operations.</span><span class="sxs-lookup"><span data-stu-id="949bd-105">You can configure automatic invoice creation in Dynamics 365 Project Operations.</span></span> <span data-ttu-id="949bd-106">Systemet opretter en proformafaktura i kladde, der er baseret på fakturaplanen for hver projektkontrakt og kontraktlinje.</span><span class="sxs-lookup"><span data-stu-id="949bd-106">The system creates a draft proforma invoice based on the invoice schedule for each project contract and contract line.</span></span> <span data-ttu-id="949bd-107">Fakturaplaner konfigureres på kontraktlinjeniveau.</span><span class="sxs-lookup"><span data-stu-id="949bd-107">Invoice schedules are configured at the contract line level.</span></span> <span data-ttu-id="949bd-108">De enkelte linjer i en kontrakt kan have en særskilt fakturaplan, eller du kan inkludere den samme fakturaplan på alle kontraktlinjer.</span><span class="sxs-lookup"><span data-stu-id="949bd-108">Each line on a contract can have a distinct invoice schedule, or the same invoice schedule can be included on every line of the contract.</span></span>

<span data-ttu-id="949bd-109">Når du opretter en faktura, opretter systemet altid mindst én faktura pr. projektkontrakt.</span><span class="sxs-lookup"><span data-stu-id="949bd-109">When you create an invoice, the system always creates at least one invoice per project contract.</span></span> <span data-ttu-id="949bd-110">I visse tilfælde kan der oprettes flere fakturaer.</span><span class="sxs-lookup"><span data-stu-id="949bd-110">In some cases, there may be multiple invoices created.</span></span>

<span data-ttu-id="949bd-111">Hvis kontrakten f.eks. har flere kunder, oprettes samme antal fakturaer som det antal kunder, der har fakturerbare transaktioner, der skal faktureres på den pågældende projektkontrakt.</span><span class="sxs-lookup"><span data-stu-id="949bd-111">For example, if the contract has multiple customers, the same number of invoices will be created as the number of customers that have billable transactions to invoice on that project contract.</span></span>

## <a name="understand-how-transactions-are-included-on-an-invoice"></a><span data-ttu-id="949bd-112">Forstå, hvordan transaktioner medtages i en faktura</span><span class="sxs-lookup"><span data-stu-id="949bd-112">Understand how transactions are included on an invoice</span></span> 

<span data-ttu-id="949bd-113">Nogle gange angiver de enkelte projektbaserede kontraktlinjer en separat fakturaplan.</span><span class="sxs-lookup"><span data-stu-id="949bd-113">Sometimes, each project-based contract line specifies a separate invoice schedule.</span></span> <span data-ttu-id="949bd-114">Implementeringsservicer for Adatum-kontrakten indeholder f.eks. følgende kontraktlinjer:</span><span class="sxs-lookup"><span data-stu-id="949bd-114">For example, implementation services for the Adatum contract have the following contract lines:</span></span>

- <span data-ttu-id="949bd-115">Prototypearbejde, der er en fast pris med to manuelt oprettede milepæle.</span><span class="sxs-lookup"><span data-stu-id="949bd-115">Prototype work that is a fixed price with two manually created milestones.</span></span>
- <span data-ttu-id="949bd-116">Implementeringsarbejde, der omfatter tid, og som vil blive faktureret mandage i hver anden uge.</span><span class="sxs-lookup"><span data-stu-id="949bd-116">Implementation work that includes Time and will be billed bi-weekly on Mondays.</span></span>
- <span data-ttu-id="949bd-117">De udgifter, der påløber, og som skal faktureres den første mandag i hver måned.</span><span class="sxs-lookup"><span data-stu-id="949bd-117">Expenses incurred that need to be billed monthly on the first Monday of each month.</span></span>

<span data-ttu-id="949bd-118">De fakturaplaner, der er defineret for hvert af disse to linjeelementer, ligner følgende tabel:</span><span class="sxs-lookup"><span data-stu-id="949bd-118">Invoice schedules defined on each of these two line items look like the following table:</span></span>

| <span data-ttu-id="949bd-119">Kontraktlinje</span><span class="sxs-lookup"><span data-stu-id="949bd-119">Contract line</span></span> | <span data-ttu-id="949bd-120">Dato for fakturakørsel</span><span class="sxs-lookup"><span data-stu-id="949bd-120">Invoice run date</span></span> | <span data-ttu-id="949bd-121">Skæringsdato for transaktion</span><span class="sxs-lookup"><span data-stu-id="949bd-121">Transaction cut-off date</span></span> | <span data-ttu-id="949bd-122">Milepælsdato</span><span class="sxs-lookup"><span data-stu-id="949bd-122">Milestone date</span></span> | <span data-ttu-id="949bd-123">Beløb for milepæl</span><span class="sxs-lookup"><span data-stu-id="949bd-123">Milestone amount</span></span> |
| --- | --- | --- | --- | --- |
| <span data-ttu-id="949bd-124">Prototypearbejde</span><span class="sxs-lookup"><span data-stu-id="949bd-124">Prototype work</span></span> | <span data-ttu-id="949bd-125">Mandag den 5. oktober</span><span class="sxs-lookup"><span data-stu-id="949bd-125">October 5, Monday</span></span> | - | <span data-ttu-id="949bd-126">Mandag den 5. oktober</span><span class="sxs-lookup"><span data-stu-id="949bd-126">October 5, Monday</span></span> | <span data-ttu-id="949bd-127">5000 USD</span><span class="sxs-lookup"><span data-stu-id="949bd-127">5000 USD</span></span> |
| - | <span data-ttu-id="949bd-128">Tirsdag den 3. november</span><span class="sxs-lookup"><span data-stu-id="949bd-128">November 3, Tuesday</span></span> | - | <span data-ttu-id="949bd-129">Tirsdag den 3. november</span><span class="sxs-lookup"><span data-stu-id="949bd-129">November 3, Tuesday</span></span> | <span data-ttu-id="949bd-130">12,000 USD</span><span class="sxs-lookup"><span data-stu-id="949bd-130">12,000 USD</span></span> |
| <span data-ttu-id="949bd-131">Implementeringsarbejde</span><span class="sxs-lookup"><span data-stu-id="949bd-131">Implementation work</span></span> | <span data-ttu-id="949bd-132">Mandag den 5. oktober</span><span class="sxs-lookup"><span data-stu-id="949bd-132">October 5, Monday</span></span> | <span data-ttu-id="949bd-133">Søndag den 4. oktober</span><span class="sxs-lookup"><span data-stu-id="949bd-133">October 4, Sunday</span></span> | - | - |
| - | <span data-ttu-id="949bd-134">Mandag den 19. oktober</span><span class="sxs-lookup"><span data-stu-id="949bd-134">October 19, Monday</span></span> | <span data-ttu-id="949bd-135">Søndag den 18. oktober</span><span class="sxs-lookup"><span data-stu-id="949bd-135">October 18, Sunday</span></span> | - | - |
| - | <span data-ttu-id="949bd-136">Mandag den 2. november</span><span class="sxs-lookup"><span data-stu-id="949bd-136">November 2, Monday</span></span> | <span data-ttu-id="949bd-137">Søndag den 1. november</span><span class="sxs-lookup"><span data-stu-id="949bd-137">November 1, Sunday</span></span> | - | - |
| - | <span data-ttu-id="949bd-138">Mandag den 16. november</span><span class="sxs-lookup"><span data-stu-id="949bd-138">November 16, Monday</span></span> | <span data-ttu-id="949bd-139">Søndag den 15. november</span><span class="sxs-lookup"><span data-stu-id="949bd-139">November 15, Sunday</span></span> | - | - |
| <span data-ttu-id="949bd-140">Påløbne udgifter</span><span class="sxs-lookup"><span data-stu-id="949bd-140">Expenses incurred</span></span> | <span data-ttu-id="949bd-141">Mandag den 5. oktober</span><span class="sxs-lookup"><span data-stu-id="949bd-141">October 5, Monday</span></span> | <span data-ttu-id="949bd-142">Søndag den 4. oktober</span><span class="sxs-lookup"><span data-stu-id="949bd-142">October 4, Sunday</span></span> | - | - |
| - | <span data-ttu-id="949bd-143">Mandag den 2. november</span><span class="sxs-lookup"><span data-stu-id="949bd-143">November 2, Monday</span></span> | <span data-ttu-id="949bd-144">Søndag den 1. november</span><span class="sxs-lookup"><span data-stu-id="949bd-144">November 1, Sunday</span></span> | - | - |

<span data-ttu-id="949bd-145">I dette eksempel, når den automatiske fakturering køres:</span><span class="sxs-lookup"><span data-stu-id="949bd-145">In this example when the automatic invoicing runs on:</span></span>

- <span data-ttu-id="949bd-146">**Den 4. oktober eller en hvilken som helst dato før** : Der genereres ikke en faktura for denne kontrakt, da tabellen **Fakturaplan** for hver af disse kontraktlinjer ikke angiver søndag den 4. oktober som en fakturakørselsdato.</span><span class="sxs-lookup"><span data-stu-id="949bd-146">**October 4 or any date before** : No invoice is generated for this contract because the **Invoice Schedule** table for each of these contract lines doesn't call out October 4, Sunday as an invoice run date.</span></span>
- <span data-ttu-id="949bd-147">**Mandag den 5. oktober** : Der oprettes en faktura for:</span><span class="sxs-lookup"><span data-stu-id="949bd-147">**October 5 Monday** : One invoice is generated for:</span></span>

    - <span data-ttu-id="949bd-148">Prototypearbejde, som inkluderer milepælen, hvis den er markeret som **Klar til fakturering**.</span><span class="sxs-lookup"><span data-stu-id="949bd-148">Prototype work that includes the milestone, if it is marked as **Ready to Invoice**.</span></span>
    - <span data-ttu-id="949bd-149">Implementeringsarbejde, som omfatter alle de tidstransaktioner, der er oprettet før skæringsdatoen for transaktioner, søndag den 4. oktober, og som er markeret med **Klar til fakturering**.</span><span class="sxs-lookup"><span data-stu-id="949bd-149">Implementation work that includes all Time transactions created before the transaction cut-off date of October 4, Sunday, that is marked as **Ready to Invoice**.</span></span>
    - <span data-ttu-id="949bd-150">Påløbne udgifter, som omfatter alle de udgiftstransaktioner, der er oprettet før skæringsdatoen for transaktioner, søndag den 4. oktober, og som er markeret med **Klar til fakturering**.</span><span class="sxs-lookup"><span data-stu-id="949bd-150">Expense incurred that includes all Expense transactions created before the transaction cut-off date of October 4, Sunday, that is marked as **Ready to Invoice**.</span></span>
  
- <span data-ttu-id="949bd-151">**Den 6. oktober eller en hvilken som helst dato før den 19. oktober** : Der genereres ikke en faktura for denne kontrakt, da tabellen **Fakturaplan** for hver af disse kontraktlinjer ikke angiver den 6. oktober eller en hvilken som helst dato før den 19. oktober som en fakturakørselsdato.</span><span class="sxs-lookup"><span data-stu-id="949bd-151">**On October 6 or any date before October 19** : No invoice is generated for this contract since the **Invoice Schedule** table for each of these contract lines does not call out October 6 or any date before October 19 as an invoice run date.</span></span>
- <span data-ttu-id="949bd-152">**Mandag den 19. oktober** : Der genereres en faktura for implementeringsarbejde, som omfatter alle de tidstransaktioner, der er oprettet før skæringsdatoen for transaktioner, søndag den 18. oktober, og som er markeret med **Klar til fakturering**.</span><span class="sxs-lookup"><span data-stu-id="949bd-152">**October 19, Monday** : One invoice is generated for implementation work that includes all Time transactions created before the transaction cut-off date of October 18, Sunday, that is marked as **Ready to Invoice**.</span></span>
- <span data-ttu-id="949bd-153">**Mandag den 2. november** : Der oprettes en faktura for:</span><span class="sxs-lookup"><span data-stu-id="949bd-153">**November 2 Monday** : One invoice is generated for:</span></span>

    - <span data-ttu-id="949bd-154">Implementeringsarbejde, som omfatter alle de tidstransaktioner, der er oprettet før skæringsdatoen for transaktioner, søndag den 1. november, og som er markeret med **Klar til fakturering**.</span><span class="sxs-lookup"><span data-stu-id="949bd-154">Implementation work that includes all Time transactions created before the transaction cut-off date of November 1, Sunday, that is marked as **Ready to Invoice**.</span></span>
    - <span data-ttu-id="949bd-155">Påløbne udgifter, som omfatter alle de udgiftstransaktioner, der er oprettet før skæringsdatoen for transaktioner, søndag den 1. november, og som er markeret med **Klar til fakturering**.</span><span class="sxs-lookup"><span data-stu-id="949bd-155">Expense incurred that includes all Expense transactions created before the transaction cut-off date of November 1, Sunday, that is marked as **Ready to Invoice**.</span></span>

- <span data-ttu-id="949bd-156">**Tirsdag den 3. november** : Der genereres en faktura for prototypearbejde, som inkluderer milepælen på 12.000 USD, hvis den er markeret som **Klar til fakturering**.</span><span class="sxs-lookup"><span data-stu-id="949bd-156">**November 3, Tuesday** : One invoice is generated for prototype work that includes the milestone for 12000 USD, if it is marked as **Ready to Invoice**.</span></span>

## <a name="configure-automatic-invoicing"></a><span data-ttu-id="949bd-157">Konfigurer automatisk fakturering</span><span class="sxs-lookup"><span data-stu-id="949bd-157">Configure automatic invoicing</span></span>

<span data-ttu-id="949bd-158">Fuldfør følgende trin for at konfigurere en automatiseret fakturakørsel.</span><span class="sxs-lookup"><span data-stu-id="949bd-158">Complete the following steps to configure an automated invoice run.</span></span>

1. <span data-ttu-id="949bd-159">I **Project Operations** skal du gå til **Indstillinger** > **Konfiguration af tilbagevende faktura**.</span><span class="sxs-lookup"><span data-stu-id="949bd-159">In **Project Operations** , go to **Settings** > **Recurring Invoice Setup**.</span></span>
2. <span data-ttu-id="949bd-160">Opret et batchjob, og navngiv det **Opret fakturaer i Project Operations**.</span><span class="sxs-lookup"><span data-stu-id="949bd-160">Create a batch job, and name it **rPoject Operations Create Invoices**.</span></span> <span data-ttu-id="949bd-161">Navnet på batchjobbet skal indeholde ordene "opret fakturaer".</span><span class="sxs-lookup"><span data-stu-id="949bd-161">The name of the batch job must include the words, "create invoices".</span></span>
3. <span data-ttu-id="949bd-162">I feltet **Jobtype** skal du vælge **Ingen**.</span><span class="sxs-lookup"><span data-stu-id="949bd-162">In the **Job Type** field, select **None**.</span></span> <span data-ttu-id="949bd-163">Som standard skal felterne **Hyppighed: Dagligt** og **Er aktiv** angives til **Ja**.</span><span class="sxs-lookup"><span data-stu-id="949bd-163">By default, the **Frequency Daily** and **Is Active** fields are set to **Yes**.</span></span>
4. <span data-ttu-id="949bd-164">Vælg **Kør arbejdsproces**.</span><span class="sxs-lookup"><span data-stu-id="949bd-164">Select **Run Workflow**.</span></span> <span data-ttu-id="949bd-165">I dialogboksen **Slå post op** kan du se tre arbejdsprocesser:</span><span class="sxs-lookup"><span data-stu-id="949bd-165">In the **Look Up Record** dialog box, you will see three workflows:</span></span>

- <span data-ttu-id="949bd-166">ProcessRunCaller</span><span class="sxs-lookup"><span data-stu-id="949bd-166">ProcessRunCaller</span></span>
- <span data-ttu-id="949bd-167">ProcessRunner</span><span class="sxs-lookup"><span data-stu-id="949bd-167">ProcessRunner</span></span>
- <span data-ttu-id="949bd-168">UpdateRoleUtilization</span><span class="sxs-lookup"><span data-stu-id="949bd-168">UpdateRoleUtilization</span></span>

5. <span data-ttu-id="949bd-169">Vælg **ProcessRunCaller** og derefter **Tilføj**.</span><span class="sxs-lookup"><span data-stu-id="949bd-169">Select **ProcessRunCaller** , and then select **Add**.</span></span>
6. <span data-ttu-id="949bd-170">I den næste dialogboks skal du vælge **OK**.</span><span class="sxs-lookup"><span data-stu-id="949bd-170">In the next dialog box, select **OK**.</span></span> <span data-ttu-id="949bd-171">En **slumre** -arbejdsproces efterfølges af en **proces** -arbejdsproces.</span><span class="sxs-lookup"><span data-stu-id="949bd-171">A **Sleep** workflow is followed by a **Process** workflow.</span></span> 

> [!NOTE]
> <span data-ttu-id="949bd-172">Du kan også vælge **ProcessRunner** i trin 5.</span><span class="sxs-lookup"><span data-stu-id="949bd-172">You can also select **ProcessRunner** in step 5.</span></span> <span data-ttu-id="949bd-173">Når du derefter vælger **OK** , efterfølges en **proces** -arbejdsproces af en **slumre** -arbejdsproces.</span><span class="sxs-lookup"><span data-stu-id="949bd-173">Then, when you select **OK** , a **Process** workflow is followed by a **Sleep** workflow.</span></span>

<span data-ttu-id="949bd-174">Begge arbejdsprocesserne **ProcessRunCaller** og **ProcessRunner** opretter fakturaer.</span><span class="sxs-lookup"><span data-stu-id="949bd-174">The **ProcessRunCaller** and **ProcessRunner** workflows create invoices.</span></span> <span data-ttu-id="949bd-175">**ProcessRunCaller** kalder på **ProcessRunner**.</span><span class="sxs-lookup"><span data-stu-id="949bd-175">**ProcessRunCaller** calls **ProcessRunner**.</span></span> <span data-ttu-id="949bd-176">**ProcessRunner** er den arbejdsproces, der rent faktisk opretter fakturaerne.</span><span class="sxs-lookup"><span data-stu-id="949bd-176">**ProcessRunner** is the workflow that actually creates the invoices.</span></span> <span data-ttu-id="949bd-177">Denne arbejdsproces gennemgår alle de kontraktlinjer, der skal oprettes fakturaer for, og opretter fakturaer for disse linjer.</span><span class="sxs-lookup"><span data-stu-id="949bd-177">The workflow goes through all the contract lines that invoices must be created for, and creates invoices for those lines.</span></span> <span data-ttu-id="949bd-178">Hvis du vil fastlægge, hvilke kontraktlinjer der skal oprettes fakturaer for, kigger jobbet på fakturaernes kørselsdatoer for kontraktlinjerne.</span><span class="sxs-lookup"><span data-stu-id="949bd-178">To determine the contract lines that invoices must be created for, the job looks at invoice run dates for the contract lines.</span></span> <span data-ttu-id="949bd-179">Hvis kontraktlinjer, der er knyttet til en kontrakt, har samme fakturakørselsdato, samles transaktionerne i én faktura, der indeholder to fakturalinjer.</span><span class="sxs-lookup"><span data-stu-id="949bd-179">If contract lines that belong to one contract have the same invoice run date, the transactions are combined into one invoice that has two invoice lines.</span></span> <span data-ttu-id="949bd-180">Hvis der ikke findes transaktioner, som der skal oprettes fakturaer til, springer jobbet over oprettelsen af en faktura.</span><span class="sxs-lookup"><span data-stu-id="949bd-180">If there are no transactions to create invoices for, the job skips creating an invoice.</span></span>

<span data-ttu-id="949bd-181">Når **ProcessRunner** er færdig med at køre, kalder processen på **ProcessRunCaller** , angiver sluttidspunktet og lukkes.</span><span class="sxs-lookup"><span data-stu-id="949bd-181">After **ProcessRunner** has finished running, it calls **ProcessRunCaller** , provides the end time, and is closed.</span></span> <span data-ttu-id="949bd-182">**ProcessRunCaller** starter derefter en timer, der kører i 24 timer fra det angivne sluttidspunkt.</span><span class="sxs-lookup"><span data-stu-id="949bd-182">**ProcessRunCaller** then starts a timer that runs for 24-hours from the specified end time.</span></span> <span data-ttu-id="949bd-183">Når timeren afsluttes, lukkes **ProcessRunCaller**.</span><span class="sxs-lookup"><span data-stu-id="949bd-183">At the end of the timer, **ProcessRunCaller** is closed.</span></span>

<span data-ttu-id="949bd-184">Batchprocesjobbet til oprettelse af fakturaer er et tilbagevendende job.</span><span class="sxs-lookup"><span data-stu-id="949bd-184">The batch process job for creating invoices is a recurrent job.</span></span> <span data-ttu-id="949bd-185">Hvis denne batchproces køres mange gange, oprettes der flere forekomster af jobbet, og der opstår fejl.</span><span class="sxs-lookup"><span data-stu-id="949bd-185">If this batch process is run many times, multiple instances of the job are created and causes errors.</span></span> <span data-ttu-id="949bd-186">Du bør derfor kun starte batchprocessen én gang og kun genstarte den, hvis den holder op med at køre.</span><span class="sxs-lookup"><span data-stu-id="949bd-186">Therefore, you should start the batch process only one time, and then restart only if it stops running.</span></span>

> [!NOTE]
> <span data-ttu-id="949bd-187">Batchfakturering i Project Operations køres kun for projektkontrakt linjer, der er konfigureret af fakturaplaner.</span><span class="sxs-lookup"><span data-stu-id="949bd-187">Batch invoicing in Project Operations only runs for project contract lines that are configured by invoice schedules.</span></span> <span data-ttu-id="949bd-188">Der skal være konfigureret målepæle for en kontraktlinje med en faktureringsmetode med fast pris.</span><span class="sxs-lookup"><span data-stu-id="949bd-188">A contract line with a fixed price billing method must have milestones configured.</span></span> <span data-ttu-id="949bd-189">Der skal konfigureres en datobaseret fakturaplan for en projektkontraktlinje med en metode til fakturering af time og materiale.</span><span class="sxs-lookup"><span data-stu-id="949bd-189">A project contract line with a time and material billing method will need a date-based invoice schedule set up.</span></span>
